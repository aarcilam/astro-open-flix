---
import Layout from '../layouts/Layout.astro';
import EpisodeList from '../components/EpisodeList.astro';
import SeasonList from '../components/SeasonList.astro';
import { scanLibrary } from '../utils/scanLibrary';

export async function getStaticPaths() {
  const series = await scanLibrary();
  return series.map((s) => ({ params: { series: s.id }, props: { series: s } }));
}

const { series } = Astro.props;
---

<Layout title={series.title}>
  <main class="container mx-auto px-4">
    <h1 class="text-4xl font-bold text-white mb-8">{series.title}</h1>
    <img src={series.thumbnail} alt={series.title} class="w-full max-w-3xl mx-auto mb-8 rounded-lg" />
    {Array.isArray(series.episodes) ? (
      <EpisodeList episodes={series.episodes} />
    ) : (
      <SeasonList seasons={series.episodes} seriesId={series.id} />
    )}
  </main>
</Layout>
